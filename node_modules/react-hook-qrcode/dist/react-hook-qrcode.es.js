import t from"buffer";import e from"fs";import r from"util";import n from"stream";import i from"zlib";import o from"assert";import{useRef as a,useEffect as s}from"react";var h=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},f=function(){try{if(!Buffer.isEncoding("latin1"))return!1;var t=Buffer.alloc?Buffer.alloc(4):new Buffer(4);return t.fill("ab","ucs2"),"61006200"===t.toString("hex")}catch(t){return!1}}();function u(t,e,r,n){if(r<0||n>t.length)throw new RangeError("Out of range index");return r>>>=0,(n=void 0===n?t.length:n>>>0)>r&&t.fill(e,r,n),t}var c=function(t,e,r,n,i){if(f)return t.fill(e,r,n,i);if("number"==typeof e)return u(t,e,r,n);if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=t.length):"string"==typeof n&&(i=n,n=t.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("latin1"===i&&(i="binary"),"string"==typeof i&&!Buffer.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(""===e)return u(t,0,r,n);if(function(t){return 1===t.length&&t.charCodeAt(0)<256}(e))return u(t,e.charCodeAt(0),r,n);e=new Buffer(e,i)}return Buffer.isBuffer(e)?function(t,e,r,n){if(r<0||n>t.length)throw new RangeError("Out of range index");if(n<=r)return t;r>>>=0,n=void 0===n?t.length:n>>>0;for(var i=r,o=e.length;i<=n-o;)e.copy(t,i),i+=o;return i!==n&&e.copy(t,i,0,n-i),t}(t,e,r,n):u(t,0,r,n)};var l=function(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative');return Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t)},d=Object.prototype.toString,p="function"==typeof Buffer.alloc&&"function"==typeof Buffer.allocUnsafe&&"function"==typeof Buffer.from;var g,_={alloc:function(t,e,r){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative');if(Buffer.alloc)return Buffer.alloc(t,e,r);var n=l(t);return 0===t?n:void 0===e?c(n,0):("string"!=typeof r&&(r=void 0),c(n,e,r))},from:function(t,e,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return n=t,"ArrayBuffer"===d.call(n).slice(8,-1)?function(t,e,r){e>>>=0;var n=t.byteLength-e;if(n<0)throw new RangeError("'offset' is out of bounds");if(void 0===r)r=n;else if((r>>>=0)>n)throw new RangeError("'length' is out of bounds");return p?Buffer.from(t.slice(e,e+r)):new Buffer(new Uint8Array(t.slice(e,e+r)))}(t,e,r):"string"==typeof t?function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!Buffer.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');return p?Buffer.from(t,e):new Buffer(t,e)}(t,e):p?Buffer.from(t):new Buffer(t);var n}},v=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],w=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},m=function(t){return v[t]},y=function(t){for(var e=0;0!==t;)e++,t>>>=1;return e},E=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');g=t},b=function(){return void 0!==g},T=function(t){return g(t)};function C(t,e){return t(e={exports:{}},e.exports),e.exports}var I=C((function(t,e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return r}}}));I.L,I.M,I.Q,I.H,I.isValid;function A(){this.buffer=[],this.length=0}A.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var P=A;function B(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=_.alloc(t*t),this.reservedBit=_.alloc(t*t)}B.prototype.set=function(t,e,r,n){var i=t*this.size+e;this.data[i]=r,n&&(this.reservedBit[i]=!0)},B.prototype.get=function(t,e){return this.data[t*this.size+e]},B.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r},B.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var L=B,R=C((function(t,e){var r=w;e.getRowColCoords=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,n=r(t),i=145===n?26:2*Math.ceil((n-13)/(2*e-2)),o=[n-7],a=1;a<e-1;a++)o[a]=o[a-1]-i;return o.push(6),o.reverse()},e.getPositions=function(t){for(var r=[],n=e.getRowColCoords(t),i=n.length,o=0;o<i;o++)for(var a=0;a<i;a++)0===o&&0===a||0===o&&a===i-1||o===i-1&&0===a||r.push([n[o],n[a]]);return r}})),O=(R.getRowColCoords,R.getPositions,w),k=function(t){var e=O(t);return[[0,0],[e-7,0],[0,e-7]]},M=C((function(t,e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var r=3,n=3,i=40,o=10;function a(t,r,n){switch(t){case e.Patterns.PATTERN000:return(r+n)%2==0;case e.Patterns.PATTERN001:return r%2==0;case e.Patterns.PATTERN010:return n%3==0;case e.Patterns.PATTERN011:return(r+n)%3==0;case e.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case e.Patterns.PATTERN101:return r*n%2+r*n%3==0;case e.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case e.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){for(var e=t.size,n=0,i=0,o=0,a=null,s=null,h=0;h<e;h++){i=o=0,a=s=null;for(var f=0;f<e;f++){var u=t.get(h,f);u===a?i++:(i>=5&&(n+=r+(i-5)),a=u,i=1),(u=t.get(f,h))===s?o++:(o>=5&&(n+=r+(o-5)),s=u,o=1)}i>=5&&(n+=r+(i-5)),o>=5&&(n+=r+(o-5))}return n},e.getPenaltyN2=function(t){for(var e=t.size,r=0,i=0;i<e-1;i++)for(var o=0;o<e-1;o++){var a=t.get(i,o)+t.get(i,o+1)+t.get(i+1,o)+t.get(i+1,o+1);4!==a&&0!==a||r++}return r*n},e.getPenaltyN3=function(t){for(var e=t.size,r=0,n=0,o=0,a=0;a<e;a++){n=o=0;for(var s=0;s<e;s++)n=n<<1&2047|t.get(a,s),s>=10&&(1488===n||93===n)&&r++,o=o<<1&2047|t.get(s,a),s>=10&&(1488===o||93===o)&&r++}return r*i},e.getPenaltyN4=function(t){for(var e=0,r=t.data.length,n=0;n<r;n++)e+=t.data[n];return Math.abs(Math.ceil(100*e/r/5)-10)*o},e.applyMask=function(t,e){for(var r=e.size,n=0;n<r;n++)for(var i=0;i<r;i++)e.isReserved(i,n)||e.xor(i,n,a(t,i,n))},e.getBestMask=function(t,r){for(var n=Object.keys(e.Patterns).length,i=0,o=1/0,a=0;a<n;a++){r(a),e.applyMask(a,t);var s=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(a,t),s<o&&(o=s,i=a)}return i}})),N=(M.Patterns,M.isValid,M.getPenaltyN1,M.getPenaltyN2,M.getPenaltyN3,M.getPenaltyN4,M.applyMask,M.getBestMask,[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81]),x=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],D=function(t,e){switch(e){case I.L:return N[4*(t-1)+0];case I.M:return N[4*(t-1)+1];case I.Q:return N[4*(t-1)+2];case I.H:return N[4*(t-1)+3];default:return}},S=function(t,e){switch(e){case I.L:return x[4*(t-1)+0];case I.M:return x[4*(t-1)+1];case I.Q:return x[4*(t-1)+2];case I.H:return x[4*(t-1)+3];default:return}},Y=_.alloc(512),U=_.alloc(256);!function(){for(var t=1,e=0;e<255;e++)Y[e]=t,U[t]=e,256&(t<<=1)&&(t^=285);for(e=255;e<512;e++)Y[e]=Y[e-255]}();var F=function(t){return Y[t]},H=function(t,e){return 0===t||0===e?0:Y[U[t]+U[e]]},z=C((function(t,e){e.mul=function(t,e){for(var r=_.alloc(t.length+e.length-1),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)r[n+i]^=H(t[n],e[i]);return r},e.mod=function(t,e){for(var r=_.from(t);r.length-e.length>=0;){for(var n=r[0],i=0;i<e.length;i++)r[i]^=H(e[i],n);for(var o=0;o<r.length&&0===r[o];)o++;r=r.slice(o)}return r},e.generateECPolynomial=function(t){for(var r=_.from([1]),n=0;n<t;n++)r=e.mul(r,[1,F(n)]);return r}})),G=(z.mul,z.mod,z.generateECPolynomial,t.Buffer);function W(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}W.prototype.initialize=function(t){this.degree=t,this.genPoly=z.generateECPolynomial(this.degree)},W.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");var e=_.alloc(this.degree),r=G.concat([t,e],t.length+this.degree),n=z.mod(r,this.genPoly),i=this.degree-n.length;if(i>0){var o=_.alloc(this.degree);return n.copy(o,i),o}return n};var j=W,K=function(t){return!isNaN(t)&&t>=1&&t<=40},V="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",J="(?:(?![A-Z0-9 $%*+\\-./:]|"+(V=V.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+",q=new RegExp(V,"g"),Q=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Z=new RegExp(J,"g"),$=new RegExp("[0-9]+","g"),X=new RegExp("[A-Z $%*+\\-./:]+","g"),tt=new RegExp("^"+V+"$"),et=new RegExp("^[0-9]+$"),rt=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),nt={KANJI:q,BYTE_KANJI:Q,BYTE:Z,NUMERIC:$,ALPHANUMERIC:X,testKanji:function(t){return tt.test(t)},testNumeric:function(t){return et.test(t)},testAlphanumeric:function(t){return rt.test(t)}},it=C((function(t,e){e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!K(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return nt.testNumeric(t)?e.NUMERIC:nt.testAlphanumeric(t)?e.ALPHANUMERIC:nt.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return r}}})),ot=(it.NUMERIC,it.ALPHANUMERIC,it.BYTE,it.KANJI,it.MIXED,it.getCharCountIndicator,it.getBestModeForData,it.isValid,{}.toString),at=Array.isArray||function(t){return"[object Array]"==ot.call(t)},st=C((function(t,e){var r=y(7973);function n(t,e){return it.getCharCountIndicator(t,e)+4}function i(t,e){var r=0;return t.forEach((function(t){var i=n(t.mode,e);r+=i+t.getBitsLength()})),r}e.from=function(t,e){return K(t)?parseInt(t,10):e},e.getCapacity=function(t,e,r){if(!K(t))throw new Error("Invalid QR Code version");void 0===r&&(r=it.BYTE);var i=8*(m(t)-S(t,e));if(r===it.MIXED)return i;var o=i-n(r,t);switch(r){case it.NUMERIC:return Math.floor(o/10*3);case it.ALPHANUMERIC:return Math.floor(o/11*2);case it.KANJI:return Math.floor(o/13);case it.BYTE:default:return Math.floor(o/8)}},e.getBestVersionForData=function(t,r){var n,o=I.from(r,I.M);if(at(t)){if(t.length>1)return function(t,r){for(var n=1;n<=40;n++){if(i(t,n)<=e.getCapacity(n,r,it.MIXED))return n}}(t,o);if(0===t.length)return 1;n=t[0]}else n=t;return function(t,r,n){for(var i=1;i<=40;i++)if(r<=e.getCapacity(i,n,t))return i}(n.mode,n.getLength(),o)},e.getEncodedBits=function(t){if(!K(t)||t<7)throw new Error("Invalid QR Code version");for(var e=t<<12;y(e)-r>=0;)e^=7973<<y(e)-r;return t<<12|e}})),ht=(st.getCapacity,st.getBestVersionForData,st.getEncodedBits,y(1335)),ft=function(t,e){for(var r=t.bit<<3|e,n=r<<10;y(n)-ht>=0;)n^=1335<<y(n)-ht;return 21522^(r<<10|n)};function ut(t){this.mode=it.NUMERIC,this.data=t.toString()}ut.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},ut.prototype.getLength=function(){return this.data.length},ut.prototype.getBitsLength=function(){return ut.getBitsLength(this.data.length)},ut.prototype.write=function(t){var e,r,n;for(e=0;e+3<=this.data.length;e+=3)r=this.data.substr(e,3),n=parseInt(r,10),t.put(n,10);var i=this.data.length-e;i>0&&(r=this.data.substr(e),n=parseInt(r,10),t.put(n,3*i+1))};var ct=ut,lt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function dt(t){this.mode=it.ALPHANUMERIC,this.data=t}dt.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},dt.prototype.getLength=function(){return this.data.length},dt.prototype.getBitsLength=function(){return dt.getBitsLength(this.data.length)},dt.prototype.write=function(t){var e;for(e=0;e+2<=this.data.length;e+=2){var r=45*lt.indexOf(this.data[e]);r+=lt.indexOf(this.data[e+1]),t.put(r,11)}this.data.length%2&&t.put(lt.indexOf(this.data[e]),6)};var pt=dt;function gt(t){this.mode=it.BYTE,this.data=_.from(t)}gt.getBitsLength=function(t){return 8*t},gt.prototype.getLength=function(){return this.data.length},gt.prototype.getBitsLength=function(){return gt.getBitsLength(this.data.length)},gt.prototype.write=function(t){for(var e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var _t=gt;function vt(t){this.mode=it.KANJI,this.data=t}vt.getBitsLength=function(t){return 13*t},vt.prototype.getLength=function(){return this.data.length},vt.prototype.getBitsLength=function(){return vt.getBitsLength(this.data.length)},vt.prototype.write=function(t){var e;for(e=0;e<this.data.length;e++){var r=T(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13)}};var wt=vt,mt=C((function(t){var e={single_source_shortest_paths:function(t,r,n){var i={},o={};o[r]=0;var a,s,h,f,u,c,l,d=e.PriorityQueue.make();for(d.push(r,0);!d.empty();)for(h in s=(a=d.pop()).value,f=a.cost,u=t[s]||{})u.hasOwnProperty(h)&&(c=f+u[h],l=o[h],(void 0===o[h]||l>c)&&(o[h]=c,d.push(h,c),i[h]=s));if(void 0!==n&&void 0===o[n]){var p=["Could not find a path from ",r," to ",n,"."].join("");throw new Error(p)}return i},extract_shortest_path_from_predecessor_list:function(t,e){for(var r=[],n=e;n;)r.push(n),t[n],n=t[n];return r.reverse(),r},find_path:function(t,r,n){var i=e.single_source_shortest_paths(t,r,n);return e.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(t){var r,n=e.PriorityQueue,i={};for(r in t=t||{},n)n.hasOwnProperty(r)&&(i[r]=n[r]);return i.queue=[],i.sorter=t.sorter||n.default_sorter,i},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var r={value:t,cost:e};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e})),yt=C((function(t,e){function r(t){return unescape(encodeURIComponent(t)).length}function n(t,e,r){for(var n,i=[];null!==(n=t.exec(r));)i.push({data:n[0],index:n.index,mode:e,length:n[0].length});return i}function i(t){var e,r,i=n(nt.NUMERIC,it.NUMERIC,t),o=n(nt.ALPHANUMERIC,it.ALPHANUMERIC,t);return b()?(e=n(nt.BYTE,it.BYTE,t),r=n(nt.KANJI,it.KANJI,t)):(e=n(nt.BYTE_KANJI,it.BYTE,t),r=[]),i.concat(o,e,r).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function o(t,e){switch(e){case it.NUMERIC:return ct.getBitsLength(t);case it.ALPHANUMERIC:return pt.getBitsLength(t);case it.KANJI:return wt.getBitsLength(t);case it.BYTE:return _t.getBitsLength(t)}}function a(t,e){var r,n=it.getBestModeForData(t);if((r=it.from(e,n))!==it.BYTE&&r.bit<n.bit)throw new Error('"'+t+'" cannot be encoded with mode '+it.toString(r)+".\n Suggested mode is: "+it.toString(n));switch(r!==it.KANJI||b()||(r=it.BYTE),r){case it.NUMERIC:return new ct(t);case it.ALPHANUMERIC:return new pt(t);case it.KANJI:return new wt(t);case it.BYTE:return new _t(t)}}e.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(a(e,null)):e.data&&t.push(a(e.data,e.mode)),t}),[])},e.fromString=function(t,n){for(var a=function(t,e){for(var r={},n={start:{}},i=["start"],a=0;a<t.length;a++){for(var s=t[a],h=[],f=0;f<s.length;f++){var u=s[f],c=""+a+f;h.push(c),r[c]={node:u,lastCount:0},n[c]={};for(var l=0;l<i.length;l++){var d=i[l];r[d]&&r[d].node.mode===u.mode?(n[d][c]=o(r[d].lastCount+u.length,u.mode)-o(r[d].lastCount,u.mode),r[d].lastCount+=u.length):(r[d]&&(r[d].lastCount=u.length),n[d][c]=o(u.length,u.mode)+4+it.getCharCountIndicator(u.mode,e))}}i=h}for(l=0;l<i.length;l++)n[i[l]].end=0;return{map:n,table:r}}(function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];switch(i.mode){case it.NUMERIC:e.push([i,{data:i.data,mode:it.ALPHANUMERIC,length:i.length},{data:i.data,mode:it.BYTE,length:i.length}]);break;case it.ALPHANUMERIC:e.push([i,{data:i.data,mode:it.BYTE,length:i.length}]);break;case it.KANJI:e.push([i,{data:i.data,mode:it.BYTE,length:r(i.data)}]);break;case it.BYTE:e.push([{data:i.data,mode:it.BYTE,length:r(i.data)}])}}return e}(i(t,b())),n),s=mt.find_path(a.map,"start","end"),h=[],f=1;f<s.length-1;f++)h.push(a.table[s[f]].node);return e.fromArray(function(t){return t.reduce((function(t,e){var r=t.length-1>=0?t[t.length-1]:null;return r&&r.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[])}(h))},e.rawSplit=function(t){return e.fromArray(i(t,b()))}}));yt.fromArray,yt.fromString,yt.rawSplit;function Et(t,e,r){var n,i,o=t.size,a=ft(e,r);for(n=0;n<15;n++)i=1==(a>>n&1),n<6?t.set(n,8,i,!0):n<8?t.set(n+1,8,i,!0):t.set(o-15+n,8,i,!0),n<8?t.set(8,o-n-1,i,!0):n<9?t.set(8,15-n-1+1,i,!0):t.set(8,15-n-1,i,!0);t.set(o-8,8,1,!0)}function bt(t,e,r){for(var n=m(e),i=n-S(e,r),o=D(e,r),a=o-n%o,s=Math.floor(n/o),h=Math.floor(i/o),f=h+1,u=s-h,c=new j(u),l=0,d=new Array(o),p=new Array(o),g=0,v=_.from(t.buffer),w=0;w<o;w++){var y=w<a?h:f;d[w]=v.slice(l,l+y),p[w]=c.encode(d[w]),l+=y,g=Math.max(g,y)}var E,b,T=_.alloc(n),C=0;for(E=0;E<g;E++)for(b=0;b<o;b++)E<d[b].length&&(T[C++]=d[b][E]);for(E=0;E<u;E++)for(b=0;b<o;b++)T[C++]=p[b][E];return T}function Tt(t,e,r,n){var i;if(at(t))i=yt.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");var o=e;if(!o){var a=yt.rawSplit(t);o=st.getBestVersionForData(a,r)}i=yt.fromString(t,o||40)}var s=st.getBestVersionForData(i,r);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<s)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+s+".\n")}else e=s;var h=function(t,e,r){var n=new P;r.forEach((function(e){n.put(e.mode.bit,4),n.put(e.getLength(),it.getCharCountIndicator(e.mode,t)),e.write(n)}));var i=8*(m(t)-S(t,e));for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);for(var o=(i-n.getLengthInBits())/8,a=0;a<o;a++)n.put(a%2?17:236,8);return bt(n,t,e)}(e,r,i),f=w(e),u=new L(f);return function(t,e){for(var r=t.size,n=k(e),i=0;i<n.length;i++)for(var o=n[i][0],a=n[i][1],s=-1;s<=7;s++)if(!(o+s<=-1||r<=o+s))for(var h=-1;h<=7;h++)a+h<=-1||r<=a+h||(s>=0&&s<=6&&(0===h||6===h)||h>=0&&h<=6&&(0===s||6===s)||s>=2&&s<=4&&h>=2&&h<=4?t.set(o+s,a+h,!0,!0):t.set(o+s,a+h,!1,!0))}(u,e),function(t){for(var e=t.size,r=8;r<e-8;r++){var n=r%2==0;t.set(r,6,n,!0),t.set(6,r,n,!0)}}(u),function(t,e){for(var r=R.getPositions(e),n=0;n<r.length;n++)for(var i=r[n][0],o=r[n][1],a=-2;a<=2;a++)for(var s=-2;s<=2;s++)-2===a||2===a||-2===s||2===s||0===a&&0===s?t.set(i+a,o+s,!0,!0):t.set(i+a,o+s,!1,!0)}(u,e),Et(u,r,0),e>=7&&function(t,e){for(var r,n,i,o=t.size,a=st.getEncodedBits(e),s=0;s<18;s++)r=Math.floor(s/3),n=s%3+o-8-3,i=1==(a>>s&1),t.set(r,n,i,!0),t.set(n,r,i,!0)}(u,e),function(t,e){for(var r=t.size,n=-1,i=r-1,o=7,a=0,s=r-1;s>0;s-=2)for(6===s&&s--;;){for(var h=0;h<2;h++)if(!t.isReserved(i,s-h)){var f=!1;a<e.length&&(f=1==(e[a]>>>o&1)),t.set(i,s-h,f),-1===--o&&(a++,o=7)}if((i+=n)<0||r<=i){i-=n,n=-n;break}}}(u,h),isNaN(n)&&(n=M.getBestMask(u,Et.bind(null,u,r))),M.applyMask(n,u),Et(u,r,n),{modules:u,version:e,errorCorrectionLevel:r,maskPattern:n,segments:i}}var Ct=function(t,e){if(void 0===t||""===t)throw new Error("No input text");var r,n,i=I.M;return void 0!==e&&(i=I.from(e.errorCorrectionLevel,I.M),r=st.from(e.version),n=M.from(e.maskPattern),e.toSJISFunc&&E(e.toSJISFunc)),Tt(t,r,i,n)},It=C((function(t){var e=t.exports=function(){n.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};r.inherits(e,n),e.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e}),process.nextTick(function(){this._process(),this._paused&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},e.prototype.write=function(t,e){return this.writable?(r=Buffer.isBuffer(t)?t:new Buffer(t,e||this._encoding),this._buffers.push(r),this._buffered+=r.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",new Error("Stream not writable")),!1);var r},e.prototype.end=function(t,e){t&&this.write(t,e),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},e.prototype.destroySoon=e.prototype.end,e.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},e.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},e.prototype._processReadAllowingLess=function(t){this._reads.shift();var e=this._buffers[0];e.length>t.length?(this._buffered-=t.length,this._buffers[0]=e.slice(t.length),t.func.call(this,e.slice(0,t.length))):(this._buffered-=e.length,this._buffers.shift(),t.func.call(this,e))},e.prototype._processRead=function(t){this._reads.shift();for(var e=0,r=0,n=new Buffer(t.length);e<t.length;){var i=this._buffers[r++],o=Math.min(i.length,t.length-e);i.copy(n,e,0,o),e+=o,o!==i.length&&(this._buffers[--r]=i.slice(o))}r>0&&this._buffers.splice(0,r),this._buffered-=t.length,t.func.call(this,n)},e.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){var t=this._reads[0];if(t.allowLess)this._processReadAllowingLess(t);else{if(!(this._buffered>=t.length))break;this._processRead(t)}}this._buffers&&!this.writable&&this._end()}catch(t){this.emit("error",t)}}})),At=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}],Pt=function(t,e){for(var r=[],n=t%8,i=e%8,o=(t-n)/8,a=(e-i)/8,s=0;s<At.length;s++){for(var h=At[s],f=o*h.x.length,u=a*h.y.length,c=0;c<h.x.length&&h.x[c]<n;c++)f++;for(c=0;c<h.y.length&&h.y[c]<i;c++)u++;f>0&&u>0&&r.push({width:f,height:u,index:s})}return r},Bt=function(t){return function(e,r,n){var i=e%At[n].x.length,o=(e-i)/At[n].x.length*8+At[n].x[i],a=r%At[n].y.length;return 4*o+((r-a)/At[n].y.length*8+At[n].y[a])*t*4}},Lt=function(t,e,r){var n=t+e-r,i=Math.abs(n-t),o=Math.abs(n-e),a=Math.abs(n-r);return i<=o&&i<=a?t:o<=a?e:r},Rt=C((function(t){function e(t,e,r){var n=t*e;return 8!==r&&(n=Math.ceil(n/(8/r))),n}var r=t.exports=function(t,r){var n=t.width,i=t.height,o=t.interlace,a=t.bpp,s=t.depth;if(this.read=r.read,this.write=r.write,this.complete=r.complete,this._imageIndex=0,this._images=[],o)for(var h=Pt(n,i),f=0;f<h.length;f++)this._images.push({byteWidth:e(h[f].width,a,s),height:h[f].height,lineIndex:0});else this._images.push({byteWidth:e(n,a,s),height:i,lineIndex:0});this._xComparison=8===s?a:16===s?2*a:1};r.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},r.prototype._unFilterType1=function(t,e,r){for(var n=this._xComparison,i=n-1,o=0;o<r;o++){var a=t[1+o],s=o>i?e[o-n]:0;e[o]=a+s}},r.prototype._unFilterType2=function(t,e,r){for(var n=this._lastLine,i=0;i<r;i++){var o=t[1+i],a=n?n[i]:0;e[i]=o+a}},r.prototype._unFilterType3=function(t,e,r){for(var n=this._xComparison,i=n-1,o=this._lastLine,a=0;a<r;a++){var s=t[1+a],h=o?o[a]:0,f=a>i?e[a-n]:0,u=Math.floor((f+h)/2);e[a]=s+u}},r.prototype._unFilterType4=function(t,e,r){for(var n=this._xComparison,i=n-1,o=this._lastLine,a=0;a<r;a++){var s=t[1+a],h=o?o[a]:0,f=a>i?e[a-n]:0,u=a>i&&o?o[a-n]:0,c=Lt(f,h,u);e[a]=s+c}},r.prototype._reverseFilterLine=function(t){var e,r=t[0],n=this._images[this._imageIndex],i=n.byteWidth;if(0===r)e=t.slice(1,i+1);else switch(e=new Buffer(i),r){case 1:this._unFilterType1(t,e,i);break;case 2:this._unFilterType2(t,e,i);break;case 3:this._unFilterType3(t,e,i);break;case 4:this._unFilterType4(t,e,i);break;default:throw new Error("Unrecognised filter type - "+r)}this.write(e),n.lineIndex++,n.lineIndex>=n.height?(this._lastLine=null,this._imageIndex++,n=this._images[this._imageIndex]):this._lastLine=e,n?this.read(n.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}})),Ot=C((function(t){var e=t.exports=function(t){It.call(this);var e=[],r=this;this._filter=new Rt(t,{read:this.read.bind(this),write:function(t){e.push(t)},complete:function(){r.emit("complete",Buffer.concat(e))}}),this._filter.start()};r.inherits(e,It)})),kt={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5},Mt=C((function(t){var e=[];!function(){for(var t=0;t<256;t++){for(var r=t,n=0;n<8;n++)1&r?r=3988292384^r>>>1:r>>>=1;e[t]=r}}();var r=t.exports=function(){this._crc=-1};r.prototype.write=function(t){for(var r=0;r<t.length;r++)this._crc=e[255&(this._crc^t[r])]^this._crc>>>8;return!0},r.prototype.crc32=function(){return-1^this._crc},r.crc32=function(t){for(var r=-1,n=0;n<t.length;n++)r=e[255&(r^t[n])]^r>>>8;return-1^r}})),Nt=C((function(t){var e=t.exports=function(t,e){this._options=t,t.checkCRC=!1!==t.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[kt.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[kt.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[kt.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[kt.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[kt.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[kt.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=e.read,this.error=e.error,this.metadata=e.metadata,this.gamma=e.gamma,this.transColor=e.transColor,this.palette=e.palette,this.parsed=e.parsed,this.inflateData=e.inflateData,this.finished=e.finished,this.simpleTransparency=e.simpleTransparency,this.headersFinished=e.headersFinished||function(){}};e.prototype.start=function(){this.read(kt.PNG_SIGNATURE.length,this._parseSignature.bind(this))},e.prototype._parseSignature=function(t){for(var e=kt.PNG_SIGNATURE,r=0;r<e.length;r++)if(t[r]!==e[r])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},e.prototype._parseChunkBegin=function(t){for(var e=t.readUInt32BE(0),r=t.readUInt32BE(4),n="",i=4;i<8;i++)n+=String.fromCharCode(t[i]);var o=Boolean(32&t[4]);if(this._hasIHDR||r===kt.TYPE_IHDR){if(this._crc=new Mt,this._crc.write(new Buffer(n)),this._chunks[r])return this._chunks[r](e);o?this.read(e+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+n))}else this.error(new Error("Expected IHDR on beggining"))},e.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},e.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},e.prototype._parseChunkEnd=function(t){var e=t.readInt32BE(0),r=this._crc.crc32();this._options.checkCRC&&r!==e?this.error(new Error("Crc error - "+e+" - "+r)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},e.prototype._handleIHDR=function(t){this.read(t,this._parseIHDR.bind(this))},e.prototype._parseIHDR=function(t){this._crc.write(t);var e=t.readUInt32BE(0),r=t.readUInt32BE(4),n=t[8],i=t[9],o=t[10],a=t[11],s=t[12];if(8===n||4===n||2===n||1===n||16===n)if(i in kt.COLORTYPE_TO_BPP_MAP)if(0===o)if(0===a)if(0===s||1===s){this._colorType=i;var h=kt.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:e,height:r,depth:n,interlace:Boolean(s),palette:Boolean(i&kt.COLORTYPE_PALETTE),color:Boolean(i&kt.COLORTYPE_COLOR),alpha:Boolean(i&kt.COLORTYPE_ALPHA),bpp:h,colorType:i}),this._handleChunkEnd()}else this.error(new Error("Unsupported interlace method"));else this.error(new Error("Unsupported filter method"));else this.error(new Error("Unsupported compression method"));else this.error(new Error("Unsupported color type"));else this.error(new Error("Unsupported bit depth "+n))},e.prototype._handlePLTE=function(t){this.read(t,this._parsePLTE.bind(this))},e.prototype._parsePLTE=function(t){this._crc.write(t);for(var e=Math.floor(t.length/3),r=0;r<e;r++)this._palette.push([t[3*r],t[3*r+1],t[3*r+2],255]);this.palette(this._palette),this._handleChunkEnd()},e.prototype._handleTRNS=function(t){this.simpleTransparency(),this.read(t,this._parseTRNS.bind(this))},e.prototype._parseTRNS=function(t){if(this._crc.write(t),this._colorType===kt.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(t.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(var e=0;e<t.length;e++)this._palette[e][3]=t[e];this.palette(this._palette)}this._colorType===kt.COLORTYPE_GRAYSCALE&&this.transColor([t.readUInt16BE(0)]),this._colorType===kt.COLORTYPE_COLOR&&this.transColor([t.readUInt16BE(0),t.readUInt16BE(2),t.readUInt16BE(4)]),this._handleChunkEnd()},e.prototype._handleGAMA=function(t){this.read(t,this._parseGAMA.bind(this))},e.prototype._parseGAMA=function(t){this._crc.write(t),this.gamma(t.readUInt32BE(0)/kt.GAMMA_DIVISION),this._handleChunkEnd()},e.prototype._handleIDAT=function(t){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-t,this._parseIDAT.bind(this,t))},e.prototype._parseIDAT=function(t,e){if(this._crc.write(e),this._colorType===kt.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(e);var r=t-e.length;r>0?this._handleIDAT(r):this._handleChunkEnd()},e.prototype._handleIEND=function(t){this.read(t,this._parseIEND.bind(this))},e.prototype._parseIEND=function(t){this._crc.write(t),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}})),xt=[function(){},function(t,e,r,n){if(n===e.length)throw new Error("Ran out of data");var i=e[n];t[r]=i,t[r+1]=i,t[r+2]=i,t[r+3]=255},function(t,e,r,n){if(n+1>=e.length)throw new Error("Ran out of data");var i=e[n];t[r]=i,t[r+1]=i,t[r+2]=i,t[r+3]=e[n+1]},function(t,e,r,n){if(n+2>=e.length)throw new Error("Ran out of data");t[r]=e[n],t[r+1]=e[n+1],t[r+2]=e[n+2],t[r+3]=255},function(t,e,r,n){if(n+3>=e.length)throw new Error("Ran out of data");t[r]=e[n],t[r+1]=e[n+1],t[r+2]=e[n+2],t[r+3]=e[n+3]}],Dt=[function(){},function(t,e,r,n){var i=e[0];t[r]=i,t[r+1]=i,t[r+2]=i,t[r+3]=n},function(t,e,r){var n=e[0];t[r]=n,t[r+1]=n,t[r+2]=n,t[r+3]=e[1]},function(t,e,r,n){t[r]=e[0],t[r+1]=e[1],t[r+2]=e[2],t[r+3]=n},function(t,e,r){t[r]=e[0],t[r+1]=e[1],t[r+2]=e[2],t[r+3]=e[3]}];function St(t,e,r,n,i,o){for(var a=t.width,s=t.height,h=t.index,f=0;f<s;f++)for(var u=0;u<a;u++){var c=r(u,f,h);xt[n](e,i,c,o),o+=n}return o}function Yt(t,e,r,n,i,o){for(var a=t.width,s=t.height,h=t.index,f=0;f<s;f++){for(var u=0;u<a;u++){var c=i.get(n),l=r(u,f,h);Dt[n](e,c,l,o)}i.resetAfterLine()}}var Ut=function(t,e){var r,n=e.width,i=e.height,o=e.depth,a=e.bpp,s=e.interlace;if(8!==o)var h=function(t,e){var r=[],n=0;function i(){if(n===t.length)throw new Error("Ran out of data");var i,o,a,s,h,f,u,c,l=t[n];switch(n++,e){default:throw new Error("unrecognised depth");case 16:u=t[n],n++,r.push((l<<8)+u);break;case 4:u=15&l,c=l>>4,r.push(c,u);break;case 2:h=3&l,f=l>>2&3,u=l>>4&3,c=l>>6&3,r.push(c,u,f,h);break;case 1:i=1&l,o=l>>1&1,a=l>>2&1,s=l>>3&1,h=l>>4&1,f=l>>5&1,u=l>>6&1,c=l>>7&1,r.push(c,u,f,h,s,a,o,i)}}return{get:function(t){for(;r.length<t;)i();var e=r.slice(0,t);return r=r.slice(t),e},resetAfterLine:function(){r.length=0},end:function(){if(n!==t.length)throw new Error("extra data found")}}}(t,o);r=o<=8?new Buffer(n*i*4):new Uint16Array(n*i*4);var f,u,c=Math.pow(2,o)-1,l=0;if(s)f=Pt(n,i),u=Bt(n,i);else{var d=0;u=function(){var t=d;return d+=4,t},f=[{width:n,height:i}]}for(var p=0;p<f.length;p++)8===o?l=St(f[p],r,u,a,t,l):Yt(f[p],r,u,a,h,c);if(8===o){if(l!==t.length)throw new Error("extra data found")}else h.end();return r};var Ft=function(t,e){var r=e.depth,n=e.width,i=e.height,o=e.colorType,a=e.transColor,s=e.palette,h=t;return 3===o?function(t,e,r,n,i){for(var o=0,a=0;a<n;a++)for(var s=0;s<r;s++){var h=i[t[o]];if(!h)throw new Error("index "+t[o]+" not in palette");for(var f=0;f<4;f++)e[o+f]=h[f];o+=4}}(t,h,n,i,s):(a&&function(t,e,r,n,i){for(var o=0,a=0;a<n;a++)for(var s=0;s<r;s++){var h=!1;if(1===i.length?i[0]===t[o]&&(h=!0):i[0]===t[o]&&i[1]===t[o+1]&&i[2]===t[o+2]&&(h=!0),h)for(var f=0;f<4;f++)e[o+f]=0;o+=4}}(t,h,n,i,a),8!==r&&(16===r&&(h=new Buffer(n*i*4)),function(t,e,r,n,i){for(var o=Math.pow(2,i)-1,a=0,s=0;s<n;s++)for(var h=0;h<r;h++){for(var f=0;f<4;f++)e[a+f]=Math.floor(255*t[a+f]/o+.5);a+=4}}(t,h,n,i,r))),h},Ht=C((function(t){var e=t.exports=function(t){It.call(this),this._parser=new Nt(t,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=t,this.writable=!0,this._parser.start()};r.inherits(e,It),e.prototype._handleError=function(t){this.emit("error",t),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},e.prototype._inflateData=function(t){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=i.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{var e=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,r=Math.max(e,i.Z_MIN_CHUNK);this._inflate=i.createInflate({chunkSize:r});var n=e,o=this.emit.bind(this,"error");this._inflate.on("error",(function(t){n&&o(t)})),this._filter.on("complete",this._complete.bind(this));var a=this._filter.write.bind(this._filter);this._inflate.on("data",(function(t){n&&(t.length>n&&(t=t.slice(0,n)),n-=t.length,a(t))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(t)},e.prototype._handleMetaData=function(t){this._metaData=t,this._bitmapInfo=Object.create(t),this._filter=new Ot(this._bitmapInfo)},e.prototype._handleTransColor=function(t){this._bitmapInfo.transColor=t},e.prototype._handlePalette=function(t){this._bitmapInfo.palette=t},e.prototype._simpleTransparency=function(){this._metaData.alpha=!0},e.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},e.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"),this.destroySoon())},e.prototype._complete=function(t){if(!this.errord){try{var e=Ut(t,this._bitmapInfo),r=Ft(e,this._bitmapInfo);e=null}catch(t){return void this._handleError(t)}this.emit("parsed",r)}}}));var zt={0:function(t,e,r,n,i){for(var o=0;o<r;o++)n[i+o]=t[e+o]},1:function(t,e,r,n,i,o){for(var a=0;a<r;a++){var s=a>=o?t[e+a-o]:0,h=t[e+a]-s;n[i+a]=h}},2:function(t,e,r,n,i){for(var o=0;o<r;o++){var a=e>0?t[e+o-r]:0,s=t[e+o]-a;n[i+o]=s}},3:function(t,e,r,n,i,o){for(var a=0;a<r;a++){var s=a>=o?t[e+a-o]:0,h=e>0?t[e+a-r]:0,f=t[e+a]-(s+h>>1);n[i+a]=f}},4:function(t,e,r,n,i,o){for(var a=0;a<r;a++){var s=a>=o?t[e+a-o]:0,h=e>0?t[e+a-r]:0,f=e>0&&a>=o?t[e+a-(r+o)]:0,u=t[e+a]-Lt(s,h,f);n[i+a]=u}}},Gt={0:function(t,e,r){for(var n=0,i=e+r,o=e;o<i;o++)n+=Math.abs(t[o]);return n},1:function(t,e,r,n){for(var i=0,o=0;o<r;o++){var a=o>=n?t[e+o-n]:0,s=t[e+o]-a;i+=Math.abs(s)}return i},2:function(t,e,r){for(var n=0,i=e+r,o=e;o<i;o++){var a=e>0?t[o-r]:0,s=t[o]-a;n+=Math.abs(s)}return n},3:function(t,e,r,n){for(var i=0,o=0;o<r;o++){var a=o>=n?t[e+o-n]:0,s=e>0?t[e+o-r]:0,h=t[e+o]-(a+s>>1);i+=Math.abs(h)}return i},4:function(t,e,r,n){for(var i=0,o=0;o<r;o++){var a=o>=n?t[e+o-n]:0,s=e>0?t[e+o-r]:0,h=e>0&&o>=n?t[e+o-(r+n)]:0,f=t[e+o]-Lt(a,s,h);i+=Math.abs(f)}return i}},Wt=C((function(t){var e=t.exports=function(t){if(this._options=t,t.deflateChunkSize=t.deflateChunkSize||32768,t.deflateLevel=null!=t.deflateLevel?t.deflateLevel:9,t.deflateStrategy=null!=t.deflateStrategy?t.deflateStrategy:3,t.inputHasAlpha=null==t.inputHasAlpha||t.inputHasAlpha,t.deflateFactory=t.deflateFactory||i.createDeflate,t.bitDepth=t.bitDepth||8,t.colorType="number"==typeof t.colorType?t.colorType:kt.COLORTYPE_COLOR_ALPHA,t.inputColorType="number"==typeof t.inputColorType?t.inputColorType:kt.COLORTYPE_COLOR_ALPHA,-1===[kt.COLORTYPE_GRAYSCALE,kt.COLORTYPE_COLOR,kt.COLORTYPE_COLOR_ALPHA,kt.COLORTYPE_ALPHA].indexOf(t.colorType))throw new Error("option color type:"+t.colorType+" is not supported at present");if(-1===[kt.COLORTYPE_GRAYSCALE,kt.COLORTYPE_COLOR,kt.COLORTYPE_COLOR_ALPHA,kt.COLORTYPE_ALPHA].indexOf(t.inputColorType))throw new Error("option input color type:"+t.inputColorType+" is not supported at present");if(8!==t.bitDepth&&16!==t.bitDepth)throw new Error("option bit depth:"+t.bitDepth+" is not supported at present")};e.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},e.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},e.prototype.filterData=function(t,e,r){var n=function(t,e,r,n){var i=-1!==[kt.COLORTYPE_COLOR_ALPHA,kt.COLORTYPE_ALPHA].indexOf(n.colorType);if(n.colorType===n.inputColorType){var o=function(){var t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256!==new Int16Array(t)[0]}();if(8===n.bitDepth||16===n.bitDepth&&o)return t}var a=16!==n.bitDepth?t:new Uint16Array(t.buffer),s=255,h=kt.COLORTYPE_TO_BPP_MAP[n.inputColorType];4!==h||n.inputHasAlpha||(h=3);var f=kt.COLORTYPE_TO_BPP_MAP[n.colorType];16===n.bitDepth&&(s=65535,f*=2);var u=new Buffer(e*r*f),c=0,l=0,d=n.bgColor||{};function p(){var t,e,r,o=s;switch(n.inputColorType){case kt.COLORTYPE_COLOR_ALPHA:o=a[c+3],t=a[c],e=a[c+1],r=a[c+2];break;case kt.COLORTYPE_COLOR:t=a[c],e=a[c+1],r=a[c+2];break;case kt.COLORTYPE_ALPHA:o=a[c+1],e=t=a[c],r=t;break;case kt.COLORTYPE_GRAYSCALE:e=t=a[c],r=t;break;default:throw new Error("input color type:"+n.inputColorType+" is not supported at present")}return n.inputHasAlpha&&(i||(o/=s,t=Math.min(Math.max(Math.round((1-o)*d.red+o*t),0),s),e=Math.min(Math.max(Math.round((1-o)*d.green+o*e),0),s),r=Math.min(Math.max(Math.round((1-o)*d.blue+o*r),0),s))),{red:t,green:e,blue:r,alpha:o}}void 0===d.red&&(d.red=s),void 0===d.green&&(d.green=s),void 0===d.blue&&(d.blue=s);for(var g=0;g<r;g++)for(var _=0;_<e;_++){var v=p();switch(n.colorType){case kt.COLORTYPE_COLOR_ALPHA:case kt.COLORTYPE_COLOR:8===n.bitDepth?(u[l]=v.red,u[l+1]=v.green,u[l+2]=v.blue,i&&(u[l+3]=v.alpha)):(u.writeUInt16BE(v.red,l),u.writeUInt16BE(v.green,l+2),u.writeUInt16BE(v.blue,l+4),i&&u.writeUInt16BE(v.alpha,l+6));break;case kt.COLORTYPE_ALPHA:case kt.COLORTYPE_GRAYSCALE:var w=(v.red+v.green+v.blue)/3;8===n.bitDepth?(u[l]=w,i&&(u[l+1]=v.alpha)):(u.writeUInt16BE(w,l),i&&u.writeUInt16BE(v.alpha,l+2));break;default:throw new Error("unrecognised color Type "+n.colorType)}c+=h,l+=f}return u}(t,e,r,this._options),i=kt.COLORTYPE_TO_BPP_MAP[this._options.colorType];return function(t,e,r,n,i){var o;if("filterType"in n&&-1!==n.filterType){if("number"!=typeof n.filterType)throw new Error("unrecognised filter types");o=[n.filterType]}else o=[0,1,2,3,4];16===n.bitDepth&&(i*=2);for(var a=e*i,s=0,h=0,f=new Buffer((a+1)*r),u=o[0],c=0;c<r;c++){if(o.length>1)for(var l=1/0,d=0;d<o.length;d++){var p=Gt[o[d]](t,h,a,i);p<l&&(u=o[d],l=p)}f[s]=u,s++,zt[u](t,h,a,f,s,i),s+=a,h+=a}return f}(n,e,r,this._options,i)},e.prototype._packChunk=function(t,e){var r=e?e.length:0,n=new Buffer(r+12);return n.writeUInt32BE(r,0),n.writeUInt32BE(t,4),e&&e.copy(n,8),n.writeInt32BE(Mt.crc32(n.slice(4,n.length-4)),n.length-4),n},e.prototype.packGAMA=function(t){var e=new Buffer(4);return e.writeUInt32BE(Math.floor(t*kt.GAMMA_DIVISION),0),this._packChunk(kt.TYPE_gAMA,e)},e.prototype.packIHDR=function(t,e){var r=new Buffer(13);return r.writeUInt32BE(t,0),r.writeUInt32BE(e,4),r[8]=this._options.bitDepth,r[9]=this._options.colorType,r[10]=0,r[11]=0,r[12]=0,this._packChunk(kt.TYPE_IHDR,r)},e.prototype.packIDAT=function(t){return this._packChunk(kt.TYPE_IDAT,t)},e.prototype.packIEND=function(){return this._packChunk(kt.TYPE_IEND,null)}})),jt=C((function(t){var e=t.exports=function(t){n.call(this);var e=t||{};this._packer=new Wt(e),this._deflate=this._packer.createDeflate(),this.readable=!0};r.inherits(e,n),e.prototype.pack=function(t,e,r,n){this.emit("data",new Buffer(kt.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(e,r)),n&&this.emit("data",this._packer.packGAMA(n));var i=this._packer.filterData(t,e,r);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(t){this.emit("data",this._packer.packIDAT(t))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(i)}})),Kt=C((function(e,n){var a=o.ok,s=t.kMaxLength;function h(t){if(!(this instanceof h))return new h(t);t&&t.chunkSize<i.Z_MIN_CHUNK&&(t.chunkSize=i.Z_MIN_CHUNK),i.Inflate.call(this,t),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,t&&null!=t.maxLength&&(this._maxLength=t.maxLength)}function f(t,e){e&&process.nextTick(e),t._handle&&(t._handle.close(),t._handle=null)}function u(t,e){return function(t,e){if("string"==typeof e&&(e=Buffer.from(e)),!(e instanceof Buffer))throw new TypeError("Not a string or buffer");var r=t._finishFlushFlag;return null==r&&(r=i.Z_FINISH),t._processChunk(e,r)}(new h(e),t)}h.prototype._processChunk=function(t,e,r){if("function"==typeof r)return i.Inflate._processChunk.call(this,t,e,r);var n,o=this,h=t&&t.length,u=this._chunkSize-this._offset,c=this._maxLength,l=0,d=[],p=0;function g(t,e){if(!o._hadError){var r=u-e;if(a(r>=0,"have should not go down"),r>0){var n=o._buffer.slice(o._offset,o._offset+r);if(o._offset+=r,n.length>c&&(n=n.slice(0,c)),d.push(n),p+=n.length,0===(c-=n.length))return!1}return(0===e||o._offset>=o._chunkSize)&&(u=o._chunkSize,o._offset=0,o._buffer=Buffer.allocUnsafe(o._chunkSize)),0===e&&(l+=h-t,h=t,!0)}}this.on("error",(function(t){n=t})),a(this._handle,"zlib binding closed");do{var _=this._handle.writeSync(e,t,l,h,this._buffer,this._offset,u);_=_||this._writeState}while(!this._hadError&&g(_[0],_[1]));if(this._hadError)throw n;if(p>=s)throw f(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+s.toString(16)+" bytes");var v=Buffer.concat(d,p);return f(this),v},r.inherits(h,i.Inflate),e.exports=n=u,n.Inflate=h,n.createInflate=function(t){return new h(t)},n.inflateSync=u})),Vt=(Kt.Inflate,Kt.createInflate,Kt.inflateSync,C((function(t){var e=t.exports=function(t){this._buffer=t,this._reads=[]};e.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e})},e.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){var t=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=t.length||t.allowLess))break;this._reads.shift();var e=this._buffer;this._buffer=e.slice(t.length),t.func.call(this,e.slice(0,t.length))}return this._reads.length>0?new Error("There are some read requests waitng on finished stream"):this._buffer.length>0?new Error("unrecognised content at end of stream"):void 0}}))),Jt=function(t,e){var r=[],n=new Vt(t);return new Rt(e,{read:n.read.bind(n),write:function(t){r.push(t)},complete:function(){}}).start(),n.process(),Buffer.concat(r)},qt=!0;i.deflateSync||(qt=!1);var Qt=!0;i.deflateSync||(Qt=!1);var Zt={read:function(t,e){return function(t,e){if(!qt)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var r,n,o;var a=[];var s=new Vt(t);if(new Nt(e,{read:s.read.bind(s),error:function(t){r=t},metadata:function(t){n=t},gamma:function(t){o=t},palette:function(t){n.palette=t},transColor:function(t){n.transColor=t},inflateData:function(t){a.push(t)},simpleTransparency:function(){n.alpha=!0}}).start(),s.process(),r)throw r;var h,f=Buffer.concat(a);if(a.length=0,n.interlace)h=i.inflateSync(f);else{var u=(1+(n.width*n.bpp*n.depth+7>>3))*n.height;h=Kt(f,{chunkSize:u,maxLength:u})}if(f=null,!h||!h.length)throw new Error("bad png - invalid inflate data response");var c=Jt(h,n);f=null;var l=Ut(c,n);c=null;var d=Ft(l,n);return n.data=d,n.gamma=o||0,n}(t,e||{})},write:function(t,e){return function(t,e){if(!Qt)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var r=new Wt(e||{}),n=[];n.push(new Buffer(kt.PNG_SIGNATURE)),n.push(r.packIHDR(t.width,t.height)),t.gamma&&n.push(r.packGAMA(t.gamma));var o=r.filterData(t.data,t.width,t.height),a=i.deflateSync(o,r.getDeflateOptions());if(o=null,!a||!a.length)throw new Error("bad png - invalid compressed data response");return n.push(r.packIDAT(a)),n.push(r.packIEND()),Buffer.concat(n)}(t,e)}},$t=C((function(t,e){var i=e.PNG=function(t){n.call(this),t=t||{},this.width=0|t.width,this.height=0|t.height,this.data=this.width>0&&this.height>0?new Buffer(4*this.width*this.height):null,t.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new Ht(t),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(t){this.data=t,this.emit("parsed",t)}.bind(this)),this._packer=new jt(t),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};r.inherits(i,n),i.sync=Zt,i.prototype.pack=function(){return this.data&&this.data.length?(process.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},i.prototype.parse=function(t,e){var r,n;e&&(r=function(t){this.removeListener("error",n),this.data=t,e(null,this)}.bind(this),n=function(t){this.removeListener("parsed",r),e(t,null)}.bind(this),this.once("parsed",r),this.once("error",n));return this.end(t),this},i.prototype.write=function(t){return this._parser.write(t),!0},i.prototype.end=function(t){this._parser.end(t)},i.prototype._metadata=function(t){this.width=t.width,this.height=t.height,this.emit("metadata",t)},i.prototype._gamma=function(t){this.gamma=t},i.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},i.bitblt=function(t,e,r,n,i,o,a,s){if(n|=0,i|=0,o|=0,a|=0,s|=0,(r|=0)>t.width||n>t.height||r+i>t.width||n+o>t.height)throw new Error("bitblt reading outside image");if(a>e.width||s>e.height||a+i>e.width||s+o>e.height)throw new Error("bitblt writing outside image");for(var h=0;h<o;h++)t.data.copy(e.data,(s+h)*e.width+a<<2,(n+h)*t.width+r<<2,(n+h)*t.width+r+i<<2)},i.prototype.bitblt=function(t,e,r,n,o,a,s){return i.bitblt(this,t,e,r,n,o,a,s),this},i.adjustGamma=function(t){if(t.gamma){for(var e=0;e<t.height;e++)for(var r=0;r<t.width;r++)for(var n=t.width*e+r<<2,i=0;i<3;i++){var o=t.data[n+i]/255;o=Math.pow(o,1/2.2/t.gamma),t.data[n+i]=Math.round(255*o)}t.gamma=0}},i.prototype.adjustGamma=function(){i.adjustGamma(this)}})),Xt=($t.PNG,C((function(t,e){function r(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");var r=parseInt(e.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});var e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,n=t.width&&t.width>=21?t.width:void 0,i=t.scale||4;return{width:n,scale:n?4:i,margin:e,color:{dark:r(t.color.dark||"#000000ff"),light:r(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,r){var n=e.getScale(t,r);return Math.floor((t+2*r.margin)*n)},e.qrToImageData=function(t,r,n){for(var i=r.modules.size,o=r.modules.data,a=e.getScale(i,n),s=Math.floor((i+2*n.margin)*a),h=n.margin*a,f=[n.color.light,n.color.dark],u=0;u<s;u++)for(var c=0;c<s;c++){var l=4*(u*s+c),d=n.color.light;if(u>=h&&c>=h&&u<s-h&&c<s-h)d=f[o[Math.floor((u-h)/a)*i+Math.floor((c-h)/a)]?1:0];t[l++]=d.r,t[l++]=d.g,t[l++]=d.b,t[l]=d.a}}}))),te=(Xt.getOptions,Xt.getScale,Xt.getImageWidth,Xt.qrToImageData,C((function(t,r){var n=$t.PNG;r.render=function(t,e){var r=Xt.getOptions(e),i=r.rendererOpts,o=Xt.getImageWidth(t.modules.size,r);i.width=o,i.height=o;var a=new n(i);return Xt.qrToImageData(a.data,t,r),a},r.renderToDataURL=function(t,e,n){void 0===n&&(n=e,e=void 0),r.renderToBuffer(t,e,(function(t,e){t&&n(t);var r="data:image/png;base64,";r+=e.toString("base64"),n(null,r)}))},r.renderToBuffer=function(t,e,n){void 0===n&&(n=e,e=void 0);var i=r.render(t,e),o=[];i.on("error",n),i.on("data",(function(t){o.push(t)})),i.on("end",(function(){n(null,Buffer.concat(o))})),i.pack()},r.renderToFile=function(t,n,i,o){void 0===o&&(o=i,i=void 0);var a=e.createWriteStream(t);a.on("error",o),a.on("close",o),r.renderToFileStream(a,n,i)},r.renderToFileStream=function(t,e,n){r.render(e,n).pack().pipe(t)}}))),ee=(te.render,te.renderToDataURL,te.renderToBuffer,te.renderToFile,te.renderToFileStream,C((function(t,r){var n={WW:" ",WB:"▄",BB:"█",BW:"▀"},i={BB:" ",BW:"▄",WW:"█",WB:"▀"};function o(t,e,r){return t&&e?r.BB:t&&!e?r.BW:!t&&e?r.WB:r.WW}r.render=function(t,e,r){var a=Xt.getOptions(e),s=n;"#ffffff"!==a.color.dark.hex&&"#000000"!==a.color.light.hex||(s=i);var h=t.modules.size,f=t.modules.data,u="",c=Array(h+2*a.margin+1).join(s.WW);c=Array(a.margin/2+1).join(c+"\n");var l=Array(a.margin+1).join(s.WW);u+=c;for(var d=0;d<h;d+=2){u+=l;for(var p=0;p<h;p++){u+=o(f[d*h+p],f[(d+1)*h+p],s)}u+=l+"\n"}return u+=c.slice(0,-1),"function"==typeof r&&r(null,u),u},r.renderToFile=function(t,n,i,o){void 0===o&&(o=i,i=void 0);var a=e,s=r.render(n,i);a.writeFile(t,s,o)}}))),re=(ee.render,ee.renderToFile,{render:function(t,e,r){var n=t.modules.size,i=t.modules.data,o="[47m  [0m",a="",s=Array(n+3).join(o),h=Array(2).join(o);a+=s+"\n";for(var f=0;f<n;++f){a+=o;for(var u=0;u<n;u++)a+=i[f*n+u]?"[40m  [0m":o;a+=h+"\n"}return a+=s+"\n","function"==typeof r&&r(null,a),a}});function ne(t,e){var r=t.a/255,n=e+'="'+t.hex+'"';return r<1?n+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function ie(t,e,r){var n=t+e;return void 0!==r&&(n+=" "+r),n}var oe=function(t,e,r){var n=Xt.getOptions(e),i=t.modules.size,o=t.modules.data,a=i+2*n.margin,s=n.color.light.a?"<path "+ne(n.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",h="<path "+ne(n.color.dark,"stroke")+' d="'+function(t,e,r){for(var n="",i=0,o=!1,a=0,s=0;s<t.length;s++){var h=Math.floor(s%e),f=Math.floor(s/e);h||o||(o=!0),t[s]?(a++,s>0&&h>0&&t[s-1]||(n+=o?ie("M",h+r,.5+f+r):ie("m",i,0),i=0,o=!1),h+1<e&&t[s+1]||(n+=ie("h",a),a=0)):i++}return n}(o,i,n.margin)+'"/>',f='viewBox="0 0 '+a+" "+a+'"',u='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+f+' shape-rendering="crispEdges">'+s+h+"</svg>\n";return"function"==typeof r&&r(null,u),u},ae=C((function(t,r){r.render=oe,r.renderToFile=function(t,n,i,o){void 0===o&&(o=i,i=void 0);var a=e,s='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+r.render(n,i);a.writeFile(t,s,o)}})),se=(ae.render,ae.renderToFile,C((function(t,e){e.render=function(t,e,r){var n=r,i=e;void 0!==n||e&&e.getContext||(n=e,e=void 0),e||(i=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),n=Xt.getOptions(n);var o=Xt.getImageWidth(t.modules.size,n),a=i.getContext("2d"),s=a.createImageData(o,o);return Xt.qrToImageData(s.data,t,n),function(t,e,r){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=r,e.width=r,e.style.height=r+"px",e.style.width=r+"px"}(a,i,o),a.putImageData(s,0,0),i},e.renderToDataURL=function(t,r,n){var i=n;void 0!==i||r&&r.getContext||(i=r,r=void 0),i||(i={});var o=e.render(t,r,i),a=i.type||"image/png",s=i.rendererOpts||{};return o.toDataURL(a,s.quality)}})));se.render,se.renderToDataURL;function he(t,e,r,n,i){var o=[].slice.call(arguments,1),a=o.length,s="function"==typeof o[a-1];if(!s&&!h())throw new Error("Callback required as last argument");if(!s){if(a<1)throw new Error("Too few arguments provided");return 1===a?(r=e,e=n=void 0):2!==a||e.getContext||(n=r,r=e,e=void 0),new Promise((function(i,o){try{var a=Ct(r,n);i(t(a,e,n))}catch(t){o(t)}}))}if(a<2)throw new Error("Too few arguments provided");2===a?(i=r,r=e,e=n=void 0):3===a&&(e.getContext&&void 0===i?(i=n,n=void 0):(i=n,n=r,r=e,e=void 0));try{var f=Ct(r,n);i(null,t(f,e,n))}catch(t){i(t)}}var fe=Ct,ue=he.bind(null,se.render),ce=he.bind(null,se.renderToDataURL),le=he.bind(null,(function(t,e,r){return oe(t,r)}));function de(t,e,r){if(void 0===t)throw new Error("String required as first argument");if(void 0===r&&(r=e,e={}),"function"!=typeof r){if(!h())throw new Error("Callback required as last argument");e=r||{},r=null}return{opts:e,cb:r}}function pe(t){return t.slice(2+(t.lastIndexOf(".")-1>>>0)).toLowerCase()}function ge(t){switch(t){case"svg":return ae;case"txt":case"utf8":return ee;case"png":case"image/png":default:return te}}function _e(t,e,r){if(!r.cb)return new Promise((function(n,i){try{var o=Ct(e,r.opts);return t(o,r.opts,(function(t,e){return t?i(t):n(e)}))}catch(t){i(t)}}));try{var n=Ct(e,r.opts);return t(n,r.opts,r.cb)}catch(t){r.cb(t)}}var ve={create:Ct,toCanvas:{create:fe,toCanvas:ue,toDataURL:ce,toString:le}.toCanvas,toString:function(t,e,r){var n=de(t,e,r);return _e(function(t){switch(t){case"svg":return ae;case"terminal":return re;case"utf8":default:return ee}}(n.opts.type).render,t,n)},toDataURL:function(t,e,r){var n=de(t,e,r);return _e(ge(n.opts.type).renderToDataURL,t,n)},toBuffer:function(t,e,r){var n=de(t,e,r);return _e(ge(n.opts.type).renderToBuffer,t,n)},toFile:function(t,e,r,n){if("string"!=typeof t||"string"!=typeof e&&"object"!=typeof e)throw new Error("Invalid argument");if(arguments.length<3&&!h())throw new Error("Too few arguments provided");var i=de(e,r,n),o=i.opts.type||pe(t),a=ge(o),s=a.renderToFile.bind(null,t);return _e(s,e,i)},toFileStream:function(t,e,r){if(arguments.length<2)throw new Error("Too few arguments provided");var n=de(e,r,t.emit.bind(t,"error")),i=ge("png"),o=i.renderToFileStream.bind(null,t);_e(o,e,n)}};function we(t){var e=
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}(t,[]);const r=a(),{text:n,options:i}=e;return s((function(){if(r){const t=r;"CANVAS"===t.current.tagName?ve.toCanvas(t.current,n,i,(function(t){if(t)throw t})):ve.toDataURL(n,i,(function(e,r){if(e)throw e;t.current.src=r}))}}),[n,i]),[r]}export{we as useQRCode};
